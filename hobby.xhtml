<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!--This file was converted to xhtml by OpenOffice.org - see http://xml.openoffice.org/odf2xhtml for more info.--><head profile="http://dublincore.org/documents/dcmi-terms/"><meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/><title xml:lang="en-US">- no title specified</title><meta name="DCTERMS.title" content="" xml:lang="en-US"/><meta name="DCTERMS.language" content="en-US" scheme="DCTERMS.RFC4646"/><meta name="DCTERMS.source" content="http://xml.openoffice.org/odf2xhtml"/><meta name="DCTERMS.issued" content="2021-08-05T09:11:13.12" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.modified" content="2021-09-10T09:32:19.63" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.provenance" content="" xml:lang="en-US"/><meta name="DCTERMS.subject" content="," xml:lang="en-US"/><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" hreflang="en"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" hreflang="en"/><link rel="schema.DCTYPE" href="http://purl.org/dc/dcmitype/" hreflang="en"/><link rel="schema.DCAM" href="http://purl.org/dc/dcam/" hreflang="en"/><style type="text/css">
	@page {  }
	table { border-collapse:collapse; border-spacing:0; empty-cells:show }
	td, th { vertical-align:top; font-size:12pt;}
	h1, h2, h3, h4, h5, h6 { clear:both }
	ol, ul { margin:0; padding:0;}
	li { list-style: none; margin:0; padding:0;}
	<!-- "li span.odfLiEnd" - IE 7 issue-->
	li span. { clear: both; line-height:0; width:0; height:0; margin:0; padding:0; }
	span.footnodeNumber { padding-right:1em; }
	span.annotation_style_by_filter { font-size:95%; font-family:Arial; background-color:#fff000;  margin:0; border:0; padding:0;  }
	* { margin:0;}
	.fr1 { font-size:12pt; margin-left:0.0791in; margin-right:0.0791in; vertical-align:top; writing-mode:lr-tb; }
	.P1 { font-size:12pt; font-family:Arial; writing-mode:page; }
	.P10 { font-size:9.80000019073486pt; margin-bottom:0in; margin-top:0in; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#080808; }
	.P11 { font-size:9.80000019073486pt; margin-bottom:0in; margin-top:0in; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#080808; font-weight:normal; }
	.P12 { font-size:9.80000019073486pt; margin-bottom:0in; margin-top:0in; font-family:Courier New, monospace; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#080808; font-weight:normal; }
	.P13 { font-size:9.80000019073486pt; margin-bottom:0in; margin-top:0in; font-family:JetBrains Mono, monospace; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#080808; }
	.P14 { font-size:10pt; margin-bottom:0in; margin-top:0in; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; }
	.P15 { font-size:9.80000019073486pt; margin-bottom:0in; margin-top:0in; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#1750eb; }
	.P16 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#000000; font-weight:normal; }
	.P17_borderStart { font-size:12pt; margin-top:0in; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; background-color:#ffffff; color:#000000; font-weight:normal; padding-bottom:0.1965in;  border-bottom-style:none; }
	.P17 { font-size:12pt; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; background-color:#ffffff; color:#000000; font-weight:normal; padding-bottom:0.1965in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P17_borderEnd { font-size:12pt; margin-bottom:0.1965in; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; background-color:#ffffff; color:#000000; font-weight:normal; padding-top:0in;  border-top-style:none;}
	.P18_borderStart { font-size:9.80000019073486pt; margin-top:0in; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; background-color:#ffffff; color:#000000; font-weight:normal; padding-bottom:0.1965in;  border-bottom-style:none; }
	.P18 { font-size:9.80000019073486pt; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; background-color:#ffffff; color:#000000; font-weight:normal; padding-bottom:0.1965in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P18_borderEnd { font-size:9.80000019073486pt; margin-bottom:0.1965in; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; background-color:#ffffff; color:#000000; font-weight:normal; padding-top:0in;  border-top-style:none;}
	.P19 { font-size:12pt; margin-bottom:0.0835in; margin-left:0.1965in; margin-right:0in; margin-top:0in; text-indent:0in; font-family:Arial; writing-mode:page; }
	.P2 { font-size:12pt; font-family:Arial; writing-mode:page; }
	.P20_borderStart { font-size:10pt; margin-top:0in; font-family:Courier New; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0in;  border-bottom-style:none; }
	.P20 { font-size:10pt; font-family:Courier New; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P20_borderEnd { font-size:10pt; margin-bottom:0in; font-family:Courier New; writing-mode:page; background-color:#ffffff; color:#080808; padding-top:0in;  border-top-style:none;}
	.P21_borderStart { font-size:10pt; margin-top:0in; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0in;  border-bottom-style:none; }
	.P21 { font-size:10pt; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P21_borderEnd { font-size:10pt; margin-bottom:0in; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#080808; padding-top:0in;  border-top-style:none;}
	.P22_borderStart { font-size:9.80000019073486pt; margin-top:0in; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0in;  border-bottom-style:none; }
	.P22 { font-size:9.80000019073486pt; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P22_borderEnd { font-size:9.80000019073486pt; margin-bottom:0in; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#080808; padding-top:0in;  border-top-style:none;}
	.P23_borderStart { font-size:9.80000019073486pt; margin-top:0in; font-family:JetBrains Mono, monospace; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0in;  border-bottom-style:none; }
	.P23 { font-size:9.80000019073486pt; font-family:JetBrains Mono, monospace; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P23_borderEnd { font-size:9.80000019073486pt; margin-bottom:0in; font-family:JetBrains Mono, monospace; writing-mode:page; background-color:#ffffff; color:#080808; padding-top:0in;  border-top-style:none;}
	.P24_borderStart { font-size:9.80000019073486pt; margin-top:0in; font-family:JetBrains Mono, monospace; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0in;  border-bottom-style:none; }
	.P24 { font-size:9.80000019073486pt; font-family:JetBrains Mono, monospace; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P24_borderEnd { font-size:9.80000019073486pt; margin-bottom:0in; font-family:JetBrains Mono, monospace; writing-mode:page; background-color:#ffffff; color:#080808; padding-top:0in;  border-top-style:none;}
	.P25_borderStart { font-size:12pt; margin-top:0in; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#000000; font-weight:normal; padding-bottom:0in;  border-bottom-style:none; }
	.P25 { font-size:12pt; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#000000; font-weight:normal; padding-bottom:0in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P25_borderEnd { font-size:12pt; margin-bottom:0in; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#000000; font-weight:normal; padding-top:0in;  border-top-style:none;}
	.P26_borderStart { font-size:12pt; margin-top:0in; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#1750eb; padding-bottom:0in;  border-bottom-style:none; }
	.P26 { font-size:12pt; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#1750eb; padding-bottom:0in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P26_borderEnd { font-size:12pt; margin-bottom:0in; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#1750eb; padding-top:0in;  border-top-style:none;}
	.P27_borderStart { font-size:9.80000019073486pt; margin-top:0in; font-family:JetBrains Mono, monospace; writing-mode:page; background-color:#ffffff; color:#1750eb; padding-bottom:0in;  border-bottom-style:none; }
	.P27 { font-size:9.80000019073486pt; font-family:JetBrains Mono, monospace; writing-mode:page; background-color:#ffffff; color:#1750eb; padding-bottom:0in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P27_borderEnd { font-size:9.80000019073486pt; margin-bottom:0in; font-family:JetBrains Mono, monospace; writing-mode:page; background-color:#ffffff; color:#1750eb; padding-top:0in;  border-top-style:none;}
	.P28_borderStart { font-size:9.80000019073486pt; margin-top:0in; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0.1965in;  border-bottom-style:none; }
	.P28 { font-size:9.80000019073486pt; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0.1965in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P28_borderEnd { font-size:9.80000019073486pt; margin-bottom:0.1965in; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#080808; padding-top:0in;  border-top-style:none;}
	.P29_borderStart { font-size:9.80000019073486pt; margin-top:0in; font-family:Courier New, monospace; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0.1965in;  border-bottom-style:none; }
	.P29 { font-size:9.80000019073486pt; font-family:Courier New, monospace; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0.1965in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P29_borderEnd { font-size:9.80000019073486pt; margin-bottom:0.1965in; font-family:Courier New, monospace; writing-mode:page; background-color:#ffffff; color:#080808; padding-top:0in;  border-top-style:none;}
	.P3 { font-size:14pt; margin-bottom:0.0835in; margin-top:0.1665in; font-family:Arial; writing-mode:page; font-weight:bold; }
	.P30_borderStart { font-size:10pt; margin-top:0in; font-family:JetBrains Mono, monospace; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0.1965in;  border-bottom-style:none; }
	.P30 { font-size:10pt; font-family:JetBrains Mono, monospace; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0.1965in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P30_borderEnd { font-size:10pt; margin-bottom:0.1965in; font-family:JetBrains Mono, monospace; writing-mode:page; background-color:#ffffff; color:#080808; padding-top:0in;  border-top-style:none;}
	.P31_borderStart { font-size:9.80000019073486pt; margin-top:0in; font-family:JetBrains Mono, monospace; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0.1965in;  border-bottom-style:none; }
	.P31 { font-size:9.80000019073486pt; font-family:JetBrains Mono, monospace; writing-mode:page; background-color:#ffffff; color:#080808; padding-bottom:0.1965in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P31_borderEnd { font-size:9.80000019073486pt; margin-bottom:0.1965in; font-family:JetBrains Mono, monospace; writing-mode:page; background-color:#ffffff; color:#080808; padding-top:0in;  border-top-style:none;}
	.P32_borderStart { font-size:10pt; margin-top:0in; font-family:Arial; writing-mode:page; background-color:#ffffff; padding-bottom:0.1965in;  border-bottom-style:none; }
	.P32 { font-size:10pt; font-family:Arial; writing-mode:page; background-color:#ffffff; padding-bottom:0.1965in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P32_borderEnd { font-size:10pt; margin-bottom:0.1965in; font-family:Arial; writing-mode:page; background-color:#ffffff; padding-top:0in;  border-top-style:none;}
	.P33 { font-size:9.80000019073486pt; margin-bottom:0in; margin-top:0in; font-family:Arial; writing-mode:page; color:#080808; }
	.P34 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Arial; writing-mode:page; }
	.P35 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Arial; writing-mode:page; font-weight:normal; }
	.P36 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Arial; writing-mode:page; }
	.P37 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Arial; writing-mode:page; font-weight:bold; }
	.P38 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Arial; writing-mode:page; color:#000000; }
	.P39 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Arial; writing-mode:page; color:#000000; font-weight:normal; }
	.P4 { font-size:14pt; margin-bottom:0.0835in; margin-top:0.1665in; font-family:Arial; writing-mode:page; font-weight:bold; }
	.P40 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Arial; writing-mode:page; color:#000000; font-weight:normal; }
	.P41 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Arial; writing-mode:page; color:#1750eb; }
	.P42 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Arial; writing-mode:page; font-weight:normal; }
	.P43 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Arial; writing-mode:page; font-weight:bold; }
	.P44 { font-size:12pt; font-weight:bold; margin-bottom:0.0835in; margin-top:0.1665in; font-family:Arial; writing-mode:page; }
	.P45 { font-size:12pt; font-weight:bold; margin-bottom:0.0835in; margin-top:0.1665in; font-family:Arial; writing-mode:page; }
	.P46 { font-size:12pt; font-weight:bold; margin-bottom:0.0835in; margin-top:0.1665in; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; }
	.P47 { font-size:115%; font-weight:bold; margin-bottom:0.0835in; margin-top:0.1665in; font-family:Arial; writing-mode:page; }
	.P48 { font-size:12pt; margin-bottom:0.0835in; margin-left:0.1965in; margin-right:0in; margin-top:0in; text-indent:0in; font-family:Times New Roman; writing-mode:page; }
	.P49 { font-size:12pt; margin-bottom:0.0835in; margin-left:0.1965in; margin-right:0in; margin-top:0in; text-indent:0in; font-family:Arial; writing-mode:page; }
	.P5 { font-size:14pt; margin-bottom:0.0835in; margin-top:0.1665in; font-family:Arial; writing-mode:page; }
	.P51_borderStart { font-size:12pt; margin-top:0in; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#000000; font-weight:normal; padding-bottom:0.1965in;  border-bottom-style:none; }
	.P51 { font-size:12pt; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#000000; font-weight:normal; padding-bottom:0.1965in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P51_borderEnd { font-size:12pt; margin-bottom:0.1965in; font-family:Arial; writing-mode:page; background-color:#ffffff; color:#000000; font-weight:normal; padding-top:0in;  border-top-style:none;}
	.P57 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Arial; writing-mode:page; font-weight:normal; }
	.P58 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Arial; writing-mode:page; font-weight:bold; }
	.P59 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Arial; writing-mode:page; color:#000000; font-weight:normal; }
	.P6 { font-size:12pt; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; margin-top:0in; text-indent:0in; font-family:Arial; writing-mode:page; }
	.P60 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; font-weight:normal; }
	.P61_borderStart { font-size:12pt; margin-top:0in; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; background-color:#ffffff; color:#000000; font-weight:normal; padding-bottom:0.1965in;  border-bottom-style:none; }
	.P61 { font-size:12pt; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; background-color:#ffffff; color:#000000; font-weight:normal; padding-bottom:0.1965in; padding-top:0in;  border-top-style:none; border-bottom-style:none; }
	.P61_borderEnd { font-size:12pt; margin-bottom:0.1965in; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; background-color:#ffffff; color:#000000; font-weight:normal; padding-top:0in;  border-top-style:none;}
	.P7 { font-size:12pt; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; margin-top:0in; text-indent:0in; font-family:Arial; writing-mode:page; font-weight:bold; }
	.P8 { font-size:12pt; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; margin-top:0in; text-indent:0in; font-family:Arial; writing-mode:page; font-weight:normal; }
	.P9 { font-size:12pt; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; margin-top:0in; text-indent:0in; font-family:Arial; writing-mode:page; color:#000000; font-weight:normal; }
	.Standard { font-size:12pt; font-family:Times New Roman; writing-mode:page; }
	.Text_20_body { font-size:12pt; font-family:Times New Roman; writing-mode:page; margin-top:0in; margin-bottom:0.0835in; }
	.Text_20_body_20_indent { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Times New Roman; writing-mode:page; margin-left:0.1965in; margin-right:0in; text-indent:0in; }
	.Bullet_20_Symbols { font-family:OpenSymbol; }
	.Internet_20_link { color:#000080; text-decoration:underline; }
	.T1 { color:#0033b3; }
	.T10 { color:#000000; font-family:Arial; font-style:italic; font-weight:normal; }
	.T11 { color:#000000; font-size:9.80000019073486pt; }
	.T12 { color:#000000; }
	.T13 { color:#000000; font-style:italic; }
	.T14 { color:#000000; font-style:italic; }
	.T15 { color:#000080; font-size:9.80000019073486pt; }
	.T16 { color:#000080; font-family:JetBrains Mono, monospace; font-size:9.80000019073486pt; }
	.T17 { color:#1750eb; }
	.T18 { color:#1750eb; font-size:9.80000019073486pt; }
	.T19 { color:#1750eb; font-family:JetBrains Mono, monospace; }
	.T2 { color:#0033b3; font-size:9.80000019073486pt; }
	.T20 { color:#1750eb; font-family:JetBrains Mono, monospace; font-size:9.80000019073486pt; }
	.T21 { color:#1750eb; }
	.T22 { color:#1750eb; font-family:JetBrains Mono, monospace; font-weight:normal; }
	.T23 { color:#1750eb; font-weight:normal; }
	.T25 { font-weight:bold; }
	.T26 { color:#008080; font-size:9.80000019073486pt; font-weight:bold; }
	.T27 { color:#008080; font-family:JetBrains Mono, monospace; font-size:9.80000019073486pt; font-weight:bold; }
	.T28 { color:#008080; font-family:Courier New, monospace; font-size:9.80000019073486pt; font-weight:bold; }
	.T29 { color:#080808; font-size:9.80000019073486pt; }
	.T3 { color:#0033b3; font-family:JetBrains Mono, monospace; font-size:9.80000019073486pt; }
	.T30 { font-weight:normal; }
	.T31 { vertical-align:super; font-size:58%;}
	.T33 { font-weight:normal; }
	.T34 { font-family:JetBrains Mono, monospace; font-weight:normal; }
	.T35 { vertical-align:sub; font-size:58%;}
	.T36 { vertical-align:sub; font-size:58%;font-weight:normal; }
	.T37 { font-size:9.80000019073486pt; }
	.T38 { font-family:Arial; }
	.T39 { font-family:Arial; font-style:italic; }
	.T4 { color:#000000; }
	.T40 { font-style:normal; }
	.T41 { font-family:JetBrains Mono, monospace; }
	.T42 { font-family:JetBrains Mono, monospace; font-size:9.80000019073486pt; }
	.T43 { color:#8c8c8c; }
	.T44 { color:#8c8c8c; font-family:JetBrains Mono, monospace; font-size:9.80000019073486pt; font-style:italic; }
	.T45 { vertical-align:super; font-size:75%;}
	.T46 { vertical-align:super; font-size:75%;font-family:Arial; }
	.T48 { font-weight:bold; }
	.T49 { font-style:italic; }
	.T5 { color:#000000; background-color:#ffffff; }
	.T50 { font-weight:normal; }
	.T51 { font-style:italic; }
	.T54 { color:#6666ff; }
	.T6 { color:#000000; }
	.T7 { color:#000000; font-weight:normal; }
	.T8 { color:#000000; font-style:italic; font-weight:normal; }
	.T9 { color:#000000; font-family:Arial; font-weight:normal; }
	<!-- ODF styles with no properties representable as CSS -->
	.Footnote_20_Symbol .Numbering_20_Symbols .T32 .T47 .T53 { }
	</style></head><body dir="ltr" style="max-width:8.5in;margin-top:0.7874in; margin-bottom:0.7874in; margin-left:0.7874in; margin-right:0.7874in; "><h1 class="P47"><a id="a__Rubber_duck_math__RSA"><span/></a>Rubber duck math: RSA</h1><p class="Standard"><span class="T38">One topic that I always wanted to learn was mathematics. I never had the opportunity to develop a strong foundation outside of what's needed for day to day programming. The following was created to systematically track my own learning in what's known as </span><a href="https://en.wikipedia.org/wiki/Rubber_duck_debugging" class="Internet_20_link"><span class="T38">rubber duck debugging</span></a><span class="T38"> style; Writing down what I need to know and then find ways to figure that out. I personally find it easier to learn with numeric examples and that's the path taken here. The goal is to build up a full understanding of the topic at hand.</span></p><p class="P1"> </p><p class="P1"> </p><p class="P1">Topic 1: RSA <br/>Since this is learning by example I've picked out RSA cryptography as the starting point. I use RSA day to day in my life as a software engineer. I setup keys for my Linux machines and log in remotely using RSA keys. Yet I have never taken the time to dive in and understand it fully. I can read the Wikipedia article on RSA and I get a vague gist. But I do not have a good understanding of mathematics. So I will need to take it slowly and build a knowledge base as i go.<br/></p><p class="Text_20_body"><a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" class="Internet_20_link"><span class="T38">From Wikipedia:</span></a></p><p class="Text_20_body_20_indent"><span class="T38">“A basic principle behind RSA is the observation that it is practical to find three very large positive integers </span><span class="T39">e</span><span class="T38">, </span><span class="T39">d</span><span class="T38">, and </span><span class="T39">n</span><span class="T38">, such that with </span><a href="https://en.wikipedia.org/wiki/Modular_exponentiation" class="Internet_20_link"><span class="T38">modular exponentiation</span></a><span class="T38"> for all integers </span><span class="T39">m</span><span class="T38"> (with 0 ≤ </span><span class="T39">m</span><span class="T38"> &lt; </span><span class="T39">n</span><span class="T38">): </span></p><p class="P19">(m<span class="T45">e</span>)<span class="T45">d</span> ≡ m (mod n) </p><p class="Text_20_body_20_indent"><span class="T38">and that knowing </span><span class="T39">e</span><span class="T38"> and </span><span class="T39">n</span><span class="T38">, or even </span><span class="T39">m</span><span class="T38">, it can be extremely difficult to find </span><span class="T39">d</span><span class="T38">. The </span><a href="https://en.wikipedia.org/wiki/Triple_bar" class="Internet_20_link"><span class="T38">triple bar</span></a><span class="T38"> (≡) here denotes </span><a href="https://en.wikipedia.org/wiki/Modular_arithmetic" class="Internet_20_link"><span class="T38">modular congruence</span></a><span class="T38">. </span></p><p class="P19">In addition, for some operations it is convenient that the order of the two exponentiations can be changed and that this relation also implies:</p><p class="Text_20_body_20_indent"><span class="T38">(m</span><span class="T46">d</span><span class="T38">)</span><span class="T46">e</span><span class="T38"> ≡ m (mod n)”</span></p><p class="P19"> </p><p class="P5">Exponents under modulo </p><p class="P6">The above (m<span class="T45">e</span>)<span class="T45">d</span> ≡ m (mod n) statement is new to me. A base to a certain power under modulo returns the base? </p><p class="P6">Lets load up Python and numerically play with exponents under modulo in order to build up a strong understanding. We'll start with 2<span class="T45">x</span> mod 9 as a toy example.</p><p class="P6"> </p><p class="P6">Here's some Python code to generate exponents under a modulo for the sake of playing with this:</p><p class="P10"><span class="T1">def </span><span class="T4">exponentiate</span>(base, modulo, iterations):</p><p class="P21_borderStart">    <span class="T37">current = 1</span></p><p class="P21">    <span class="T2">for </span><span class="T37">exponent </span><span class="T2">in </span><span class="T15">range</span><span class="T37">(</span><span class="T18">0</span><span class="T37">, iterations):</span></p><p class="P21">        <span class="T15">print</span><span class="T37">(</span><span class="T15">str</span><span class="T37">(base) + </span><span class="T26">"^" </span><span class="T37">+ </span><span class="T15">str</span><span class="T37">(exponent) + </span><span class="T26">" mod " </span><span class="T37">+ </span><span class="T15">str</span><span class="T37">(modulo) +</span></p><p class="P21">              <span class="T26">" = " </span><span class="T37">+ </span><span class="T15">str</span><span class="T37">(current % modulo))</span></p><p class="P21">        <span class="T37">current = current * base</span></p><p class="P32_borderEnd"><span class="T29">exponentiate(</span><span class="T18">2</span><span class="T29">, </span><span class="T18">9</span><span class="T29">, </span><span class="T18">12</span><span class="T29">)</span></p><p class="P7">2<span class="T47">x</span> mod 9:</p><p class="P10"><span class="T17">2^0 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 1</span></p><p class="P22_borderStart"><span class="T17">2</span>^<span class="T17">1 </span>mod <span class="T17">9 </span>= <span class="T17">2</span></p><p class="P22"><span class="T17">2</span>^<span class="T17">2 </span>mod <span class="T17">9 </span>= <span class="T17">4</span></p><p class="P22"><span class="T17">2</span>^<span class="T17">3 </span>mod <span class="T17">9 </span>= <span class="T17">8</span></p><p class="P22"><span class="T17">2</span>^<span class="T17">4 </span>mod <span class="T17">9 </span>= <span class="T17">7</span></p><p class="P22"><span class="T17">2</span>^<span class="T17">5 </span>mod <span class="T17">9 </span>= <span class="T17">5</span></p><p class="P22"><span class="T17">2</span>^<span class="T17">6 </span>mod <span class="T17">9 </span>= <span class="T17">1</span></p><p class="P22"><span class="T17">2</span>^<span class="T17">7 </span>mod <span class="T17">9 </span>= <span class="T17">2</span></p><p class="P22"><span class="T17">2</span>^<span class="T17">8 </span>mod <span class="T17">9 </span>= <span class="T17">4</span></p><p class="P22"><span class="T17">2</span>^<span class="T17">9 </span>mod <span class="T17">9 </span>= <span class="T17">8</span></p><p class="P22"><span class="T17">2</span>^<span class="T17">10 </span>mod <span class="T17">9 </span>= <span class="T17">7</span></p><p class="P22"><span class="T17">2</span>^<span class="T17">11 </span>mod <span class="T17">9 </span>= <span class="T17">5</span></p><p class="P32_borderEnd"><span class="T18">2</span><span class="T29">^</span><span class="T18">12 </span><span class="T29">mod </span><span class="T18">9 </span><span class="T29">= </span><span class="T18">1</span></p><p class="P6">The result of exponentiation does loop. 1, 2, 4, 8, 7, 5 repeats as a sequence. Buy why?</p><p class="P6">Lets keep playing</p><p class="P6"><span class="T25">3</span><span class="T48">x</span><span class="T25"> mod 9:</span></p><p class="P10"><span class="T17">3^0 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T5">=</span><span class="T17"> 1</span></p><p class="P22_borderStart"><span class="T17">3</span>^<span class="T17">1 </span>mod <span class="T17">9 </span>= <span class="T17">3</span></p><p class="P22"><span class="T17">3</span>^<span class="T17">2 </span>mod <span class="T17">9 </span>= <span class="T17">0</span></p><p class="P32_borderEnd"><span class="T18">3</span><span class="T29">^</span><span class="T18">3 </span><span class="T29">mod </span><span class="T18">9 </span><span class="T29">= </span><span class="T18">0</span></p><p class="P6">This one doesn't loop. It just goes to 0 and never moves from there. </p><p class="P7">4<span class="T47">x</span> mod 9:</p><p class="P10"><span class="T17">4</span><span class="T17">^0 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 1</span></p><p class="P22_borderStart"><span class="T17">4</span>^<span class="T17">1 </span>mod <span class="T17">9 </span>= <span class="T17">4</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">2 </span>mod <span class="T17">9 </span>= <span class="T17">7</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">3 </span>mod <span class="T17">9 </span>= <span class="T17">1</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">4 </span>mod <span class="T17">9 </span>= <span class="T17">4</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">5 </span>mod <span class="T17">9 </span>= <span class="T17">7</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">6 </span>mod <span class="T17">9 </span>= <span class="T17">1</span></p><p class="P28_borderEnd"><span class="T17">4</span>^<span class="T17">7 </span>mod <span class="T17">9 </span>= <span class="T17">4</span></p><p class="P6">Ok this loops as well. At a different rate than 2<span class="T47">x</span>. It loops every 3 rather than every 6 powers.</p><p class="P7">5<span class="T47">x</span> mod 9:</p><p class="P10"><span class="T17">5^0 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 1</span></p><p class="P22_borderStart"><span class="T17">5</span>^<span class="T17">1 </span>mod <span class="T17">9 </span>= <span class="T17">5</span></p><p class="P22"><span class="T17">5</span>^<span class="T17">2 </span>mod <span class="T17">9 </span>= <span class="T17">7</span></p><p class="P22"><span class="T17">5</span>^<span class="T17">3 </span>mod <span class="T17">9 </span>= <span class="T17">8</span></p><p class="P22"><span class="T17">5</span>^<span class="T17">4 </span>mod <span class="T17">9 </span>= <span class="T17">4</span></p><p class="P22"><span class="T17">5</span>^<span class="T17">5 </span>mod <span class="T17">9 </span>= <span class="T17">2</span></p><p class="P22"><span class="T17">5</span>^<span class="T17">6 </span>mod <span class="T17">9 </span>= <span class="T17">1</span></p><p class="P28_borderEnd"><span class="T17">5</span>^<span class="T17">7 </span>mod <span class="T17">9 </span>= <span class="T17">5</span></p><p class="P6">This loops every 6 <span class="T4">powers, just like 2</span><span class="T12">x</span>.</p><p class="P7">6<span class="T47">x</span> mod 9:</p><p class="P14"><span class="T18">6^0 </span><span class="T11">mod</span><span class="T18"> 9 </span><span class="T11">=</span><span class="T18"> 1</span></p><p class="P14"><span class="T18">6^1 </span><span class="T11">mod</span><span class="T18"> 9 </span><span class="T11">=</span><span class="T18"> 6</span></p><p class="P14"><span class="T18">6^2 </span><span class="T11">mod</span><span class="T18"> 9 </span><span class="T11">=</span><span class="T18"> 0</span></p><p class="P14"><span class="T18">6^3 </span><span class="T11">mod</span><span class="T18"> 9 </span><span class="T11">=</span><span class="T18"> 0</span></p><p class="P15"> </p><p class="P34">Again this one just gets stuck on 0 and stays there.</p><p class="P7">7<span class="T47">x</span> mod 9:</p><p class="P10"><span class="T17">7^0 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 1</span></p><p class="P10"><span class="T17">7^1 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 7</span></p><p class="P10"><span class="T17">7^2 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 4</span></p><p class="P10"><span class="T17">7^3 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 1</span></p><p class="P10"><span class="T17">7^4 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 7</span></p><p class="P10"><span class="T17">7^5 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 4</span></p><p class="P10"><span class="T17">7^6 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 1</span></p><p class="P10"><span class="T17">7^7 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 7</span></p><p class="P15"> </p><p class="P38">Loops every 3 powers.</p><p class="P7">8<span class="T47">x</span> mod 9:</p><p class="P10"><span class="T17">8^0 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 1</span></p><p class="P10"><span class="T17">8^1 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 8</span></p><p class="P10"><span class="T17">8^2 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 1</span></p><p class="P10"><span class="T17">8^3 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 8</span></p><p class="P10"><span class="T17">8^4 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 1</span></p><p class="P10"><span class="T17">8^5 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 8</span></p><p class="P10"><span class="T17">8^6 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 1</span></p><p class="P10"><span class="T17">8^7 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 8</span></p><p class="P15"> </p><p class="P38">Loops every 2 powers. This makes sense since it's congruent to -1 under mod 9.</p><p class="P41"> </p><p class="P8">We'll stop here since 9<span class="T47">x</span> mod 9 is 0, 10<span class="T47">x</span> mod 9 is just going to be the same as 1<span class="T47">x</span> mod 9 and 11<span class="T47">x</span> mod 9 the same as 2<span class="T47">x</span> mod 9 and so on. </p><p class="P8">We've covered all bases (pun intended).</p><p class="P8">Some observations;</p><h6 class="P44"><a id="a__If_the_base_does_not_share_a_factor_of_9_you'll_never_get_a_factor_of_9_as_the_result_"><span/></a>If the base does not share a factor of 9 you'll never get a factor of 9 as the result.</h6><p class="P36">Bases coprime (no shared factors) to 9 will never generate 0, 3 or 6 as the result of modulo 9 under any power since that would require being a multiple of 3 to start with. As for bases that do share a factor of 9 they are less interesting here and don't behave the same way since they only generate factors of 9. We'll only look at coprime bases from here on.</p><h6 class="P44"><a id="a__For_coprime_bases_there_must_be_a_loop__The_maximum_size_of_that_loop_is_6_elements_"><span/></a>For coprime bases there must be a loop. The maximum size of that loop is 6 elements.</h6><p class="P36">We've established {0, 3, 6} will never be a result from a<span class="T47">x </span><span class="T31"> </span>mod 9 unless the base was already factor of 9. </p><p class="P36">With {0, 3, 6} ruled out it only leaves {1, 2, 4, 5, 7, 8} as possible results. <span class="T25">That's 6 possible results which is known as Euler's totient for 9</span><span class="T30">.</span> </p><p class="P36">Powers are a repeated operation so as soon as a single result repeats we know we will repeat the sequence from there. We couldn't expect a loop to occur after 6 powers because there simply aren't enough unique possible results and any duplicate would mean the loop has already begun. So it must loop and the maximum loop size will be every 6th power. </p><h6 class="P44"><a id="a__Some_loops_occur_every_2_or_3_powers_rather_than_every_6_"><span/></a>Some loops occur every 2 or 3 powers rather than every 6.</h6><p class="P2">Lets look at 4<span class="T47">x</span> as a numeric example to further play with. If we multiply the results of 4<span class="T47">x</span> mod 9 by an offset we should get new results. Lets play with this in Python to get a feel for the results and see if we learn anything from this.</p><p class="P1"> </p><p class="P33"><span class="T1">def </span><span class="T4">exponentiate_and_multiply</span>(base, modulo, iterations, multiple):</p><p class="P21_borderStart">    <span class="T37">current = </span><span class="T18">1</span></p><p class="P21"><span class="T17">    </span><span class="T2">for </span><span class="T37">exponent </span><span class="T2">in </span><span class="T15">range</span><span class="T37">(</span><span class="T18">0</span><span class="T37">, iterations):</span></p><p class="P21">        <span class="T15">print</span><span class="T37">(</span><span class="T15">str</span><span class="T37">(base) + </span><span class="T26">"^" </span><span class="T37">+ </span><span class="T15">str</span><span class="T37">(exponent) +</span></p><p class="P21">              <span class="T26">" * " </span><span class="T37">+ </span><span class="T15">str</span><span class="T37">(multiple) + </span><span class="T26">" mod " </span><span class="T37">+ </span><span class="T15">str</span><span class="T37">(modulo) +</span></p><p class="P21">              <span class="T26">" = " </span><span class="T37">+ </span><span class="T15">str</span><span class="T37">((current*multiple) % modulo))</span></p><p class="P21">        <span class="T37">current = current * base</span></p><p class="P32_borderEnd"><span class="T29">exponentiate_and_multiply(</span><span class="T18">4</span><span class="T29">, </span><span class="T18">9</span><span class="T29">, </span><span class="T18">8</span><span class="T29">, </span><span class="T18">2</span><span class="T29">)</span></p><p class="P7">4<span class="T47">x</span> * 2 mod 9:</p><p class="P33"><span class="T17">4^0 </span><span class="T4">*</span><span class="T17"> 2 </span><span class="T4">mod</span><span class="T17"> 9 </span><span class="T4">=</span><span class="T17"> 2</span></p><p class="P22_borderStart"><span class="T17">4</span>^<span class="T17">1 </span>* <span class="T17">2 </span>mod <span class="T17">9 </span>= <span class="T17">8</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">2 </span>* <span class="T17">2 </span>mod <span class="T17">9 </span>= <span class="T17">5</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">3 </span>* <span class="T17">2 </span>mod <span class="T17">9 </span>= <span class="T17">2</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">4 </span>* <span class="T17">2 </span>mod <span class="T17">9 </span>= <span class="T17">8</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">5 </span>* <span class="T17">2 </span>mod <span class="T17">9 </span>= <span class="T17">5</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">6 </span>* <span class="T17">2 </span>mod <span class="T17">9 </span>= <span class="T17">2</span></p><p class="P28_borderEnd"><span class="T17">4</span>^<span class="T17">7 </span>* <span class="T17">2 </span>mod <span class="T17">9 </span>= <span class="T17">8</span></p><p class="P1">There's still 3 results before looping but they are all completely different. What about some other offsets of 4<span class="T47">x</span>?</p><p class="P1"> </p><p class="P7">4<span class="T47">x</span> * 5 mod 9:</p><p class="P33"><span class="T17">4</span>^<span class="T17">0 </span>* <span class="T17">5 </span>mod <span class="T17">9 </span>= <span class="T17">5</span></p><p class="P22_borderStart"><span class="T17">4</span>^<span class="T17">1 </span>* <span class="T17">5 </span>mod <span class="T17">9 </span>= <span class="T17">2</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">2 </span>* <span class="T17">5 </span>mod <span class="T17">9 </span>= <span class="T17">8</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">3 </span>* <span class="T17">5 </span>mod <span class="T17">9 </span>= <span class="T17">5</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">4 </span>* <span class="T17">5 </span>mod <span class="T17">9 </span>= <span class="T17">2</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">5 </span>* <span class="T17">5 </span>mod <span class="T17">9 </span>= <span class="T17">8</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">6 </span>* <span class="T17">5 </span>mod <span class="T17">9 </span>= <span class="T17">5</span></p><p class="P28_borderEnd"><span class="T17">4</span>^<span class="T17">7 </span>* <span class="T17">5 </span>mod <span class="T17">9 </span>= <span class="T17">2</span></p><p class="P38">The same sequence as 4<span class="T47">x</span> * 2 mod 9 (2,8,5), just with a different starting point.</p><p class="P7">4<span class="T47">x</span> * 7 mod 9:</p><p class="P11"><span class="T17">4</span>^<span class="T17">0 </span>* <span class="T17">7 </span>mod <span class="T17">9 </span>= <span class="T17">7</span></p><p class="P22_borderStart"><span class="T17">4</span>^<span class="T17">1 </span>* <span class="T17">7 </span>mod <span class="T17">9 </span>= <span class="T17">1</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">2 </span>* <span class="T17">7 </span>mod <span class="T17">9 </span>= <span class="T17">4</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">3 </span>* <span class="T17">7 </span>mod <span class="T17">9 </span>= <span class="T17">7</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">4 </span>* <span class="T17">7 </span>mod <span class="T17">9 </span>= <span class="T17">1</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">5 </span>* <span class="T17">7 </span>mod <span class="T17">9 </span>= <span class="T17">4</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">6 </span>* <span class="T17">7 </span>mod <span class="T17">9 </span>= <span class="T17">7</span></p><p class="P28_borderEnd"><span class="T17">4</span>^<span class="T17">7 </span>* <span class="T17">7 </span>mod <span class="T17">9 </span>= <span class="T17">1</span></p><p class="P38">The above is the same sequence as the original 4<span class="T47">x</span> mod 9 (1,4,7), just with a different starting point.</p><h6 class="P45"><a id="a__We_still_loop_at_the_same_rate_no_matter_the_offset_we_multiply_by"><span/></a>We still loop at the same rate no matter the offset we multiply by</h6><p class="P60">Every variant of <span class="T51">4</span><span class="T49">x</span><span class="T51"> * offset </span>still loops every 3 powers just as 4<span class="T47">x</span> did. This makes sense since the offset is just a static multiple so it won't change how often the loop occurs. The multiple changes the values not the loop length.</p><h6 class="P46"><a id="a__An_offset_let's_us_choose_any_starting_number_for_the_powers_to_loop_on"><span/></a>An offset let's us choose any starting number for the powers to loop on</h6><p class="P60"><span class="T51">4</span><span class="T49">x</span><span class="T51"> * offset mod 9 </span>starts on <span class="T51">offset</span> rather than at 1. So we can start with any number and from there we'll have a loop of 3 elements. </p><h6 class="P45"><a id="a__If_one_of_the_numbers_didn't_appear_previously_then_we_have_a_completely_new_set"><span/></a>If one of the numbers didn't appear previously then we have a completely new set</h6><p class="P57">Powers are a repeated operation so if you hit a result you've seen before for a given base the following results will repeat just as they did before. We see the sets of {1,4,7} and {2,8,5} appear in different contexts here and at different starting values but it's still the same repeating sequence. So if you hit any one of those numbers in these sets you're absolutely going to be repeating that set as you continue multiplying by 4.</p><p class="P57">If we hit a completely new number not yet seen then we know we must have a completely new set and as stated above that set must be the same size as previous sets. So as soon as we saw a '2' in <span class="T14">4</span><span class="T13">x</span><span class="T14"> * 2 mod 9</span><span class="T4"> </span>we knew that the next results couldn't possibly be part of the {1,4,7} set we saw earlier since we know repeatedly multiplying those numbers by 4 never produces 2 or else it would be part of that set already. It must be part of a new set of 3 numbers from the possibilities of {1,2,4,5,7,8} and numbers of that new set can't contain {1,4,7}. </p><h6 class="P44"><a id="a__So_in_short_we've_established_that_"><span/></a>So in short we've established that;</h6><p class="P57">We can start at any value so all values must be part of some set. All values can only appear once in one set. All sets must be the same size.</p><p class="P57">Breaking the 6 possible numbers {1,2,4,5,7,8} into equal sized sets that contain no duplicates across sets is only achievable by dividing by factors of 6 which is known as Euler's totient for the modulus, 9.</p><p class="P36"><br/><span class="T25">So the length of the loops we see must be factors of the Euler's totient for the modulus. That's why all loops are a factor of 6 here. They have to be!<br/><br/></span></p><p class="P57">Note that there's still a lot we haven't figured out here. We don't know why some bases specifically loop earlier than every 6 results but we can at least understand that they will always loop at a factor of 6 which is key to understanding RSA.</p><p class="P58"> </p><p class="P57">Ok this is starting to make some sense! </p><h6 class="P45"><a id="a__Lastly_can_we_figure_out_why_4x_and_7x_looped_every_three_powers?"><span/></a>Lastly can we figure out why 4<span class="T47">x</span> and 7<span class="T47">x</span> looped every three powers?</h6><p class="P57"> </p><p class="P36">We saw that 2<span class="T47">x</span> and 5<span class="T47">x</span> loop every 6 powers, the maximum. But 4<span class="T47">x</span> and 7<span class="T47">x</span> loop every 3 powers. 8<span class="T47">x</span> loops every 2 powers. The frequency of these loops, 6, 3 and 2 are all factors of 6 though. </p><p class="P36">Lets figure out why that is. 9 has prime factors of 3<span class="T47">2</span><span class="T32">. Let's look at of 2</span><span class="T47">x</span><span class="T32"> mod 3.</span></p><p class="P33"><span class="T21">2^0 </span><span class="T6">mod</span><span class="T21"> 3 </span><span class="T6">=</span><span class="T21"> 1</span></p><p class="P22_borderStart"><span class="T17">2</span>^<span class="T17">1 </span>mod <span class="T17">3 </span>= <span class="T17">2</span></p><p class="P28"><span class="T17">2</span>^<span class="T17">2 </span>mod <span class="T17">3 </span>= <span class="T17">1</span></p><p class="P51">Ok that's simple. It loops every 2 powers. 1<span class="T47">x</span> of course will always return 1 under mod 3.</p><p class="P51_borderEnd">Now there are 6 numbers under 9 that are either 1 or 2 under mod 3. There are 3 numbers under 9 that return 1 mod 3. Since 2<span class="T47">x</span> and 5<span class="T47">x</span> are congruent to 2<span class="T47">x</span> mod 3 they have 6 possible results under mod 9. Since 1<span class="T47">x</span> and 4<span class="T47">x</span> are congruent to 1<span class="T47">x</span> mod 3 they have 3 possible results. <br/><br/>So it makes sense that 4<span class="T47">x</span> always returns one of three numbers. It has to always give results that are congruent to 1 mod 3 and there are only 3 numbers under 9 that work. <br/><br/>We'll come back to this idea later when calculating the Carmichael's totient.</p><p class="P4">Euler's theorem and Fermat's little theorem</p><p class="P34">Euler's theorem that we figured out above simply states that if we raise a coprime base to Euler's totient for that base it will equal 1. We can see this in the above examples we created where 6 was found to be the Euler's totient for 9. </p><p class="P22_borderStart"><span class="T17">2</span>^<span class="T17">6 </span>mod <span class="T17">9 </span>= <span class="T17">1</span></p><p class="P22"><span class="T17">4</span>^<span class="T17">6 </span>mod <span class="T17">9 </span>= <span class="T17">1</span></p><p class="P22"><span class="T17">5</span>^<span class="T17">6 </span>mod <span class="T17">9 </span>= <span class="T17">1</span></p><p class="P22"><span class="T17">7</span>^<span class="T17">6 </span>mod <span class="T17">9 </span>= <span class="T17">1</span></p><p class="P28_borderEnd"><span class="T17">8</span>^<span class="T17">6 </span>mod <span class="T17">9 </span>= <span class="T17">1</span></p><p class="P34">This shouldn't be surprising since we now know that our loops of powers must loop at a factor of Euler's totient. They all start at 1 and all loop back to 1 at powers of that are factors of Euler's totient.</p><p class="P34">At this point lets start writing “Euler's totient” as φ(n) for brevity. That symbol is called phi. This is the standard mathematical notation for this.</p><p class="P34">Euler's theorem written down is thus.</p><p class="P37"> a<span class="T47">φ(n)</span> mod n ≡ 1 ( mod n )</p><p class="P35">or to go one power higher to match the RSA example</p><p class="P37"> a<span class="T47">φ(n)+1</span> mod n ≡ a ( mod n )</p><p class="P34">The ≡ means 'congruent' or equal under modulo. 1 and 10 are not equal generally but under mod 9 they are. </p><p class="P34">We now understand how a base to a power under modulus can equal that base!</p><p class="P34"><br/><span class="T25">Seems familiar...</span></p><p class="P34"><span class="T30">We'll talk about how to calculate Euler's totient next but we should take a quick diversion here. </span>Years ago I was made aware of some mathematics that seemed like magic. It stated the following;</p><p class="P37">If a number, n, is prime then a<span class="T47">(n-1)</span> ≡ 1 ( mod n ) </p><p class="P34">This is now understandable. If n was a prime number then by definition of prime numbers there's n - 1 numbers below it that are coprime to it. So φ(n) is n – 1 in these cases and it's just a specialization of Euler's theorem. </p><p class="P34">This is known as <a name="firstHeading"/><a href="https://en.wikipedia.org/wiki/Fermat's_little_theorem" class="Internet_20_link"><span class="T30">Fermat's little theorem</span></a><span class="T25"> </span><span class="T30">and is a very easy way to test if a number is not prime. </span></p><p class="P35">Fermat's little theorem doesn't guarantee a number is prime however since it's quite possible for φ(n) and n-1 to share factors which can lead to false positives. </p><p class="P3">So how do we calculate Euler's totient?</p><p class="P43"> </p><p class="P38"><span class="T33">At this point we're getting a good sense of why Euler's totient, φ(n), is important. It tells us when results of a</span><span class="T50">x</span><span class="T33"> mod n will loop. We can see that the RSA algorithm relies on this since it uses bases that when raised to different powers return the base itself under mod n. The powers used in RSA must be factors of φ(n)+1.</span></p><p class="P39"><br/>Since numeric examples make things clear lets numerically calculate φ(30)</p><p class="P39">To calculate φ(n) for some number, eg. 30 (2*3*5) we want to;</p><ul><li><p class="P59" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0cm">–</span>Rule out half of factors (the factors of 2)<span class="odfLiEnd"/> </p></li><li><p class="P59" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0cm">–</span>Rule out 1/3<span class="T31">rd</span> of factors in the remaining half (the factors of 3), leaving 2/3<span class="T31">rd</span> of a half.<span class="odfLiEnd"/> </p></li><li><p class="P59" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0cm">–</span>Rule out 1/5<span class="T31">th</span> of factors in what remains. Leaving 4/5<span class="T31">th</span> of that remainder.<span class="odfLiEnd"/> </p></li></ul><p class="P35"> </p><p class="P35">The formula for what we've just done is clear. For each prime factor p we are taking the remainder after ruling out 1/p<span class="T32"> of what's remaining from the previous step. The remainder of 1/p is (1 – 1/p).</span></p><p class="P35"><br/>So the formula for the probability of a number not being a multiple of <span class="T32">p</span><span class="T35">1, </span><span class="T32">p</span><span class="T35">2</span><span class="T32">,</span><span class="T35"> </span><span class="T32">p</span><span class="T35">3...</span> is the following.</p><p class="P34"><span class="T33">(1 – 1/p</span><span class="T36">1</span><span class="T33">) (1 – 1/p</span><span class="T36">2</span><span class="T33">) (1 – 1/p</span><span class="T36">3</span><span class="T33">) (1 – 1/p</span><span class="T36">4</span><span class="T33">)....  </span></p><p class="P42">Or more concisely </p><!--Next 'div' was a 'text:p'.--><div class="P34"> <!--Next '
			span' is a draw:frame.
		--><span style="height:0.422in;width:0.8047in; padding:0; " class="fr1" id="Object4"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow>
         <mrow>
          <munder>
           <mo stretchy="false">∏</mo>
           <mrow>
            <mfenced open="〈" close="〉">
             <mrow>
              <mrow>
               <mi>p</mi>
              </mrow>
              <mo stretchy="false">∣</mo>
              <mrow>
               <mi>n</mi>
              </mrow>
             </mrow>
            </mfenced>
           </mrow>
          </munder>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mrow>
              <mn>1</mn>
              <mo stretchy="false">−</mo>
              <mfrac>
               <mn>1</mn>
               <mi>p</mi>
              </mfrac>
             </mrow>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
        </mrow></math><img style="height:1.0719cm;width:2.0439cm;" alt="formula" src="data:image/*;base64,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"/></span></div><div style="clear:both; line-height:0; width:0; height:0; margin:0; padding:0;"> </div><p class="P42">This gives a fraction which represents how often a number is not already a multiple of one of those primes listed. </p><p class="P42">To turn this fraction into <span class="T4">φ(n) which is a count of numbers that aren't factors</span> simply multiply by n. </p><div class="P34">So <span class="T7">φ(n)</span> = n<span class="T33">(1 – 1/p</span><span class="T36">1</span><span class="T33">) (1 – 1/p</span><span class="T36">2</span><span class="T33">) (1 – 1/p</span><span class="T36">3</span><span class="T33">) (1 – 1/p</span><span class="T36">4</span><span class="T33">)....  =</span><span class="T7"> </span><!--Next '
			span' is a draw:frame.
		--><span style="height:0.422in;width:0.9126in; padding:0; " class="fr1" id="Object1"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow>
          <mi>n</mi>
          <mrow>
           <munder>
            <mo stretchy="false">∏</mo>
            <mrow>
             <mfenced open="〈" close="〉">
              <mrow>
               <mrow>
                <mi>p</mi>
               </mrow>
               <mo stretchy="false">∣</mo>
               <mrow>
                <mi>n</mi>
               </mrow>
              </mrow>
             </mfenced>
            </mrow>
           </munder>
           <mrow>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <mrow>
               <mn>1</mn>
               <mo stretchy="false">−</mo>
               <mfrac>
                <mn>1</mn>
                <mi>p</mi>
               </mfrac>
              </mrow>
             </mrow>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
         </mrow></math><img style="height:1.0719cm;width:2.318cm;" alt="" src="data:image/*;base64,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"/></span></div><p class="P42">We do this for all p distinct prime factors of n.</p><p class="P42"><br/>Note that distinct prime factors are slightly different to the unique prime factor. If asked for the unique prime factors you would write 20 as 2*2*5. Distinct prime factors is the de-duplicated version of this. We don't want to rule out factors of 2 twice so the distinct prime factors of 20 are only 2 and 5. </p><p class="P40"><br/>Here's the code to generate φ(n) up to a given n. We'll use this next.</p><p class="P40"> </p><p class="P24_borderStart"><span class="T1">def </span><span class="T4">calculate_eulers_totient_given_factors</span>(n, distinct_factors):</p><p class="P20">    <span class="T42">numerator = </span><span class="T20">1</span></p><p class="P20"><span class="T17">    </span><span class="T42">denominator = </span><span class="T20">1</span></p><p class="P20"><span class="T17">    </span><span class="T3">for </span><span class="T42">factor </span><span class="T3">in </span><span class="T42">distinct_factors:</span></p><p class="P20">        <span class="T44"># Calculate numerator and denominator independently to avoid FPU errors</span></p><p class="P20"><span class="T43">        </span><span class="T42">numerator *= (factor - </span><span class="T20">1</span><span class="T42">)</span></p><p class="P20">        <span class="T42">denominator *= factor</span></p><p class="P20">    <span class="T3">return </span><span class="T42">numerator*n//denominator</span></p><p class="P23"/><p class="P23"><span class="T1">def </span><span class="T4">distinct_factors</span>(n):</p><p class="P20">    <span class="T44"># Only works to 100^2</span></p><p class="P20"><span class="T43">    </span><span class="T42">primes = [</span><span class="T20">2</span><span class="T42">, </span><span class="T20">3</span><span class="T42">, </span><span class="T20">5</span><span class="T42">, </span><span class="T20">7</span><span class="T42">, </span><span class="T20">11</span><span class="T42">, </span><span class="T20">13</span><span class="T42">, </span><span class="T20">17</span><span class="T42">, </span><span class="T20">19</span><span class="T42">, </span><span class="T20">23</span><span class="T42">, </span><span class="T20">29</span><span class="T42">, </span><span class="T20">31</span><span class="T42">, </span><span class="T20">37</span><span class="T42">, </span><span class="T20">41</span><span class="T42">, </span><span class="T20">43</span><span class="T42">, </span><span class="T20">47</span><span class="T42">, </span><span class="T20">53</span><span class="T42">, </span><span class="T20">59</span><span class="T42">, </span><span class="T20">61</span><span class="T42">, </span><span class="T20">67</span><span class="T42">, </span><span class="T20">71</span><span class="T42">, </span><span class="T20">73</span><span class="T42">, </span><span class="T20">79</span><span class="T42">, </span><span class="T20">83</span><span class="T42">, </span><span class="T20">89</span><span class="T42">, </span><span class="T20">97</span><span class="T42">]</span></p><p class="P20">    <span class="T42">factors = []</span></p><p class="P20">    <span class="T3">for </span><span class="T42">f </span><span class="T3">in </span><span class="T42">primes:</span></p><p class="P20">        <span class="T3">if </span><span class="T42">n % f == </span><span class="T20">0</span><span class="T42">:</span></p><p class="P20">            <span class="T42">factors.append(f)</span></p><p class="P20">    <span class="T3">if </span><span class="T16">len</span><span class="T42">(factors) == </span><span class="T20">0</span><span class="T42">:</span></p><p class="P20">        <span class="T44"># It's prime</span></p><p class="P20"><span class="T43">        </span><span class="T42">factors.append(n)</span></p><p class="P20">    <span class="T3">return </span><span class="T42">factors</span></p><p class="P23"/><p class="P23"><span class="T1">def </span><span class="T4">generate_eulers_totient_to_n</span>(n):</p><p class="P20">    <span class="T3">for </span><span class="T42">x </span><span class="T3">in </span><span class="T16">range</span><span class="T42">(n):</span></p><p class="P20">        <span class="T16">print</span><span class="T42">(</span><span class="T27">'</span><span class="T28">φ</span><span class="T27">(' </span><span class="T42">+ </span><span class="T16">str</span><span class="T42">(x) + </span><span class="T27">')=' </span><span class="T42">+</span></p><p class="P20">              <span class="T16">str</span><span class="T42">(calculate_eulers_totient_given_factors(x, distinct_factors(x))))</span></p><p class="P23"/><p class="P31">generate_eulers_totient_to_n(<span class="T17">51</span>)</p><p class="P26"/><p class="P26"/><p class="P25_borderEnd"/><p class="P3">So now we understand (m<span class="T47">e</span>)<span class="T47">d</span> ≡ m ( mod n ) right?</p><p class="P43"> </p><p class="P42">We're just beginning to understand how this works now. Knowing Euler's theorem that  a<span class="T47">φ(n)</span> mod n ≡ 1 ( mod n ) we could make a guess that perhaps <span class="T40">e * d</span> = <span class="T4">φ(n)+1.</span></p><p class="P39"> </p><p class="P42"><span class="T4">Onto the next part of the Wikipedia article on RSA, </span><a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Key_generation" class="Internet_20_link">Key Generation</a><span class="T4">:</span></p><p class="P19">“The keys for the RSA algorithm are generated in the following way: <span class="T7"> </span></p><ol><li><ol><li><ol><li><p class="P48" style="margin-left:0.4991cm;"><span class="Numbering_20_Symbols" style="display:block;float:left;min-width:0cm">1)</span><span class="T9">Choose two distinct </span><a href="https://en.wikipedia.org/wiki/Prime_number" class="Internet_20_link"><span class="T38">prime numbers</span></a><span class="T9"> </span><span class="T10">p</span><span class="T9"> and </span><span class="T10">q</span><span class="T9">. </span><span class="T10">p</span><span class="T9"> and </span><span class="T10">q</span><span class="T9"> are kept secret.</span><span class="odfLiEnd"/> </p></li><li><p class="P49" style="margin-left:0.4991cm;"><span class="Numbering_20_Symbols" style="display:block;float:left;min-width:0cm">2)</span><span class="T7">Compute </span><span class="T8">n</span><span class="T7"> = </span><span class="T8">pq</span><span class="T7">. </span><span class="odfLiEnd"/> </p></li><li><p class="P48" style="margin-left:0.4991cm;"><span class="Numbering_20_Symbols" style="display:block;float:left;min-width:0cm">3)</span><span class="T9">Compute </span><span class="T10">λ</span><span class="T9">(</span><span class="T10">n</span><span class="T9">), where </span><span class="T10">λ</span><span class="T9"> is </span><a href="https://en.wikipedia.org/wiki/Carmichael%27s_totient_function" class="Internet_20_link"><span class="T38">Carmichael's totient function</span></a><span class="T9">. Since </span><span class="T10">n</span><span class="T9"> = </span><span class="T10">pq</span><span class="T9">, </span><span class="T10">λ</span><span class="T9">(</span><span class="T10">n</span><span class="T9">) = </span><a href="https://en.wikipedia.org/wiki/Least_common_multiple" class="Internet_20_link"><span class="T38">lcm</span></a><span class="T9">(</span><span class="T10">λ</span><span class="T9">(</span><span class="T10">p</span><span class="T9">),</span><span class="T10">λ</span><span class="T9">(</span><span class="T10">q</span><span class="T9">)), and since </span><span class="T10">p</span><span class="T9"> and </span><span class="T10">q</span><span class="T9"> are prime, </span><span class="T10">λ</span><span class="T9">(</span><span class="T10">p</span><span class="T9">) = </span><a href="https://en.wikipedia.org/wiki/Euler_totient_function" class="Internet_20_link"><span class="T10">φ</span></a><span class="T9">(</span><span class="T10">p</span><span class="T9">) = </span><span class="T10">p</span><span class="T9"> − 1 and likewise </span><span class="T10">λ</span><span class="T9">(</span><span class="T10">q</span><span class="T9">) = </span><span class="T10">q</span><span class="T9"> − 1. Hence </span><span class="T10">λ</span><span class="T9">(</span><span class="T10">n</span><span class="T9">) = lcm(</span><span class="T10">p</span><span class="T9"> − 1, </span><span class="T10">q</span><span class="T9"> − 1).”</span><span class="odfLiEnd"/> </p></li></ol></li></ol></li></ol><p class="P9"> </p><p class="P9">Ok we expected that this would use Euler's totient function but it actually uses something called Carmichael's totient function. We figured out φ(n) as the absolute worst case of when a power will loop back to the original value. But it makes sense there might be smaller numbers that are factors of φ(n) that work as well. In fact we saw some powers loop earlier than φ(n) before.</p><p class="P9"> </p><p class="P9">If two primes share factors in their individual Euler's totient then when multiplied they will actually loop earlier than Euler's totient. Lets write this out numerically to gain an understanding.</p><p class="P12">φ<span class="T41">(</span><span class="T19">3</span><span class="T41">) = </span><span class="T19">2 </span></p><p class="P29">φ<span class="T41">(</span><span class="T19">5</span><span class="T41">) = </span><span class="T19">4</span></p><p class="P16">Now φ(15) is just the multiple of φ(3) and φ(5) since the calculation of the φ(n) breaks up the factors of n and performs the same operation on each.</p><p class="P29">φ<span class="T41">(</span><span class="T19">15</span><span class="T41">) = </span><span class="T33">φ</span><span class="T34">(</span><span class="T22">3</span><span class="T34">)*</span><span class="T33">φ</span><span class="T34">(</span><span class="T22">5</span><span class="T34">) = </span><span class="T19">8</span></p><p class="P16">But lets numerically play with φ(15), skipping factors of 15 of course.</p><p class="P13"><span class="T23">2</span><span class="T23">^0 </span><span class="T7">*</span><span class="T23"> 1 </span><span class="T7">mod</span><span class="T23"> 15 </span><span class="T7">=</span><span class="T23"> 1</span></p><p class="P23_borderStart"><span class="T17">2</span>^<span class="T17">1 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">2</span></p><p class="P23"><span class="T17">2</span>^<span class="T17">2 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">4</span></p><p class="P23"><span class="T17">2</span>^<span class="T17">3 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">8</span></p><p class="P23"><span class="T17">2</span>^<span class="T17">4 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">1</span></p><p class="P27_borderEnd"/><p class="P13"><span class="T23">4</span><span class="T23">^0 </span><span class="T7">*</span><span class="T23"> 1 </span><span class="T7">mod</span><span class="T23"> 15 </span><span class="T7">=</span><span class="T23"> 1</span></p><p class="P23_borderStart"><span class="T17">4</span>^<span class="T17">1 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">4</span></p><p class="P23"><span class="T17">4</span>^<span class="T17">2 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">1</span></p><p class="P23"><span class="T17">4</span>^<span class="T17">3 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">4</span></p><p class="P31_borderEnd"><span class="T17">4</span>^<span class="T17">4 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">1</span></p><p class="P13"><span class="T23">7^0 </span><span class="T7">*</span><span class="T23"> 1 </span><span class="T7">mod</span><span class="T23"> 15 </span><span class="T7">=</span><span class="T23"> 1</span></p><p class="P23_borderStart"><span class="T17">7</span>^<span class="T17">1 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">7</span></p><p class="P23"><span class="T17">7</span>^<span class="T17">2 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">4</span></p><p class="P23"><span class="T17">7</span>^<span class="T17">3 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">13</span></p><p class="P31_borderEnd"><span class="T17">7</span>^<span class="T17">4 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">1</span></p><p class="P13"><span class="T23">8^0 </span><span class="T7">*</span><span class="T23"> 1 </span><span class="T7">mod</span><span class="T23"> 15 </span><span class="T7">=</span><span class="T23"> 1</span></p><p class="P23_borderStart"><span class="T17">8</span>^<span class="T17">1 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">8</span></p><p class="P23"><span class="T17">8</span>^<span class="T17">2 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">4</span></p><p class="P23"><span class="T17">8</span>^<span class="T17">3 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">2</span></p><p class="P31_borderEnd"><span class="T17">8</span>^<span class="T17">4 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">1</span></p><p class="P13"><span class="T23">11^0 </span><span class="T7">*</span><span class="T23"> 1 </span><span class="T7">mod</span><span class="T23"> 15 </span><span class="T7">=</span><span class="T23"> 1</span></p><p class="P23_borderStart"><span class="T17">11</span>^<span class="T17">1 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">11</span></p><p class="P23"><span class="T17">11</span>^<span class="T17">2 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">1</span></p><p class="P23"><span class="T17">11</span>^<span class="T17">3 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">11</span></p><p class="P31_borderEnd"><span class="T17">11</span>^<span class="T17">4 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">1</span></p><p class="P13"><span class="T23">13^0 </span><span class="T7">*</span><span class="T23"> 1 </span><span class="T7">mod</span><span class="T23"> 15 </span><span class="T7">=</span><span class="T23"> 1</span></p><p class="P23_borderStart"><span class="T17">13</span>^<span class="T17">1 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">13</span></p><p class="P23"><span class="T17">13</span>^<span class="T17">2 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">4</span></p><p class="P23"><span class="T17">13</span>^<span class="T17">3 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">7</span></p><p class="P31_borderEnd"><span class="T17">13</span>^<span class="T17">4 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">1</span></p><p class="P13"><span class="T23">14^0 </span><span class="T7">*</span><span class="T23"> 1 </span><span class="T7">mod</span><span class="T23"> 15 </span><span class="T7">=</span><span class="T23"> 1</span></p><p class="P23_borderStart"><span class="T17">14</span>^<span class="T17">1 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">14</span></p><p class="P23"><span class="T17">14</span>^<span class="T17">2 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">1</span></p><p class="P23"><span class="T17">14</span>^<span class="T17">3 </span>* <span class="T17">1 </span>mod <span class="T17">15 </span>= <span class="T17">14</span></p><p class="P30"><span class="T18">14</span><span class="T37">^</span><span class="T18">4 </span><span class="T37">* </span><span class="T18">1 </span><span class="T37">mod </span><span class="T18">15 </span><span class="T37">= </span><span class="T18">1</span></p><p class="P17">φ(15) = 8 but surprisingly everything loops at factors of 4 or less, never 8 itself.</p><p class="P17">If we look at results from a<span class="T45">x</span> mod 15, 3 and 5</p><p class="P23"><span class="T17">2</span>^<span class="T54">0</span><span class="T17"> </span>mod <span class="T17">3 </span>= <span class="T17">1</span></p><p class="P23"><span class="T17">2</span>^<span class="T17">1 </span>mod <span class="T17">3 </span>= <span class="T17">2</span></p><p class="P23"><span class="T17">2</span>^<span class="T17">2 </span>mod <span class="T17">3 </span>= <span class="T17">1</span></p><p class="P31"><span class="T17">2</span>^<span class="T17">3 </span>mod <span class="T17">3 </span>= <span class="T17">2</span></p><p class="P23"><span class="T17">2</span>^0<span class="T17"> </span>mod <span class="T17">5 </span>= <span class="T17">1</span></p><p class="P23"><span class="T17">2</span>^<span class="T17">1 </span>mod <span class="T17">5 </span>= <span class="T17">2</span></p><p class="P23"><span class="T17">2</span>^<span class="T17">2 </span>mod <span class="T17">5 </span>= <span class="T17">4</span></p><p class="P23"><span class="T17">2</span>^<span class="T17">3 </span>mod <span class="T17">5 </span>= <span class="T17">3</span></p><p class="P23"><span class="T17">2</span>^<span class="T17">4 </span>mod <span class="T17">5 </span>= <span class="T17">1</span></p><p class="P31"><span class="T17">2</span>^<span class="T17">5 </span>mod <span class="T17">5 </span>= <span class="T17">2</span></p><p class="P61"><span class="T53">The reason becomes clearer. A given power must be return 1 or 2 mod 3. There are 10 numbers below 15 that match. A given power must then also return 1 or 4 mod 5 (if it was 1 mod 3) or 2 or 3 mod 5 (if it was 2 mod 3). Within those 10 numbers there are only 4 that are possible. The results of powers modulus of 3 and 5 align and limit our options under mod 15. <br/><br/>The formula here is to find the least common multiple of 2 and 4. This is where the results of the totient's for 3 and 5 align. In this case it's 4 and that's our Carmichael's totient. </span></p><p class="P61"><span class="T53">Note that for primes the Carmichael's totient and Euler's totient are equivalent. So this only takes a small modification to the code above.</span></p><p class="P18"/><p class="P18"/><p class="P18"/><p class="P18_borderEnd"/><p class="P16"> </p><p class="P16"> </p></body></html>